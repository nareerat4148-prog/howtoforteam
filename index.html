<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Server & System (Pro)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- SheetJS for Excel/CSV Export/Import -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .glass-header { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .cmd-box { background-color: #1e293b; color: #38bdf8; font-family: 'Consolas', 'Monaco', monospace; padding: 4px 8px; border-radius: 4px; font-size: 0.9em; }
        .tab-btn.active { background-color: #2563eb; color: white; border-color: #2563eb; }
        .tab-content { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        /* Custom Modal */
        .modal { transition: opacity 0.25s ease; }
        body.modal-active { overflow-x: hidden; overflow-y: visible !important; }
        /* Version Table Styles */
        .ver-table th { background-color: #f1f5f9; color: #475569; font-weight: 600; }
        .ver-badge { padding: 2px 8px; border-radius: 999px; font-size: 0.75rem; font-weight: 700; }
        .badge-green { background-color: #dcfce7; color: #166534; }
        .badge-yellow { background-color: #fef9c3; color: #854d0e; }
        .badge-red { background-color: #fee2e2; color: #991b1b; }
        
        /* Language Toggle Classes - Critical for switching */
        .lang-en.hidden, .lang-th.hidden { display: none !important; }
        
        .ai-response ul { list-style-type: disc; margin-left: 1.5rem; margin-bottom: 0.5rem; }
        .ai-response ol { list-style-type: decimal; margin-left: 1.5rem; margin-bottom: 0.5rem; }
        .ai-response strong { font-weight: 700; color: #1e293b; }
        .ai-response p { margin-bottom: 0.5rem; }
        .ai-response code { background-color: #f1f5f9; padding: 2px 4px; border-radius: 4px; font-family: monospace; color: #dc2626; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 relative">

    <!-- Top Info Bar -->
    <div class="fixed top-0 left-0 w-full h-8 bg-slate-900 text-slate-300 z-50 flex items-center justify-between px-4 sm:px-6 lg:px-8 text-xs font-medium">
        <div class="flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-green-400" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
            </svg>
            <span class="lang-th">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: 23 ‡∏ò.‡∏Ñ. 2568</span>
            <span class="lang-en hidden">Last Update: 23 Dec 2025</span>
        </div>
        <div class="flex items-center gap-4">
            <div class="flex items-center gap-2">
                <span class="text-slate-500 lang-th">‡∏ú‡∏π‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</span>
                <span class="text-slate-500 lang-en hidden">Editor:</span>
                <span class="text-white font-bold bg-blue-600 px-2 py-0.5 rounded-full">‡∏ï‡∏π‡∏ô</span>
            </div>
            <!-- Language Switcher -->
            <button onclick="toggleLanguage()" class="flex items-center gap-1 bg-slate-700 hover:bg-slate-600 text-white px-3 py-0.5 rounded transition-colors border border-slate-600 shadow-sm">
                <span id="lang-icon">üáπüá≠</span> <span id="lang-text" class="font-bold">TH</span>
            </button>
        </div>
    </div>

    <!-- Navbar -->
    <nav class="glass-header fixed w-full z-40 border-b border-slate-200 shadow-sm top-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-3">
                    <div class="bg-blue-600 text-white p-2 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 01-2 2v4a2 2 0 01-2-2m-2-4h.01M17 16h.01" />
                        </svg>
                    </div>
                    <span class="font-bold text-xl text-slate-800">
                        System <span class="text-blue-600">Troubleshooter</span>
                    </span>
                </div>
                <!-- Data Management Tools -->
                <div class="flex gap-2 items-center">
                    <button onclick="toggleModal('aiModal')" class="hidden md:flex items-center gap-1 bg-gradient-to-r from-violet-600 to-indigo-600 hover:from-violet-700 hover:to-indigo-700 text-white px-3 py-1.5 rounded text-sm font-medium transition-all shadow-md border border-violet-400/30">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5"/><path d="M8.5 8.5a2.5 2.5 0 0 1 0 5 2.5 2.5 0 0 1 0-5z"/></svg> 
                        <span class="lang-th">AI ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</span><span class="lang-en hidden">AI Analyze</span>
                    </button>

                    <div class="h-6 w-px bg-slate-300 mx-1 hidden md:block"></div>

                    <button onclick="toggleModal('addModal')" class="hidden md:flex items-center gap-1 bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 rounded text-sm font-medium transition-colors">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                         <span class="lang-th">‡πÄ‡∏û‡∏¥‡πà‡∏°</span><span class="lang-en hidden">Add</span>
                    </button>

                    <button onclick="downloadTemplate()" class="hidden md:flex items-center gap-1 bg-amber-500 hover:bg-amber-600 text-white px-3 py-1.5 rounded text-sm font-medium transition-colors">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> 
                        <span class="lang-th">‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö</span><span class="lang-en hidden">Template</span>
                    </button>
                    
                    <button onclick="triggerImport()" class="hidden md:flex items-center gap-1 bg-slate-600 hover:bg-slate-700 text-white px-3 py-1.5 rounded text-sm font-medium transition-colors">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg> 
                        <span class="lang-th">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤</span><span class="lang-en hidden">Import</span>
                    </button>
                    
                    <div class="relative">
                        <button onclick="toggleExportMenu()" class="flex items-center gap-1 bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded text-sm font-medium transition-colors">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg> 
                            <span class="lang-th">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</span><span class="lang-en hidden">Export</span> ‚ñº
                        </button>
                        <div id="exportMenu" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg hidden border border-slate-200 z-50">
                            <button type="button" onclick="exportData('csv')" class="w-full text-left block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                <span class="lang-th">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô CSV</span><span class="lang-en hidden">Export as CSV</span>
                            </button>
                            <button type="button" onclick="exportData('xlsx')" class="w-full text-left block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-t border-gray-100">
                                <span class="lang-th">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô Excel</span><span class="lang-en hidden">Export as XLSX</span>
                            </button>
                        </div>
                    </div>

                    <input type="file" id="fileInput" class="hidden" accept=".csv" onchange="handleFileImport(this)">
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-32 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
        
        <!-- Search Section -->
        <div class="mb-8 text-center">
            <h1 class="text-3xl md:text-4xl font-bold mb-4 text-slate-900">
                <span class="lang-th">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ Error Code ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏û‡∏ö</span>
                <span class="lang-en hidden">Search Error Code or Symptoms</span>
            </h1>
            <div class="relative max-w-2xl mx-auto">
                <input type="text" id="searchInput" placeholder="503, App Pool, Identity, Memory..." 
                    class="w-full px-6 py-4 rounded-full border-2 border-slate-200 focus:border-blue-500 focus:outline-none shadow-lg text-lg transition-colors">
                <div class="absolute right-4 top-4 text-slate-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                </div>
            </div>
            <p id="searchStatus" class="mt-2 text-sm text-amber-600 hidden font-medium">
                <span class="lang-th">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏ó‡πá‡∏ö‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß)</span>
                <span class="lang-en hidden">Showing search results (Tabs mode disabled temporarily)</span>
            </p>
            <!-- Mobile Buttons -->
            <div class="flex md:hidden justify-center gap-2 mt-4 flex-wrap">
                <button onclick="toggleModal('aiModal')" class="bg-violet-600 text-white px-4 py-2 rounded shadow text-sm">AI Analyze</button>
                 <button onclick="toggleModal('addModal')" class="bg-emerald-600 text-white px-4 py-2 rounded shadow text-sm">Add</button>
                <button onclick="downloadTemplate()" class="bg-amber-500 text-white px-4 py-2 rounded shadow text-sm">Template</button>
                <button onclick="triggerImport()" class="bg-slate-600 text-white px-4 py-2 rounded shadow text-sm">Import</button>
                 <button onclick="clearLocalStorage()" class="bg-red-500 text-white px-4 py-2 rounded shadow text-sm">Reset</button>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="flex flex-wrap justify-center gap-2 mb-8 sticky top-24 z-30 bg-slate-50 py-2" id="tabContainer">
            <button onclick="switchTab('web-app')" id="btn-web-app" class="tab-btn active px-5 py-2.5 rounded-full border border-slate-300 bg-white text-slate-600 font-semibold hover:bg-slate-100 transition-all shadow-sm flex items-center gap-2">
                <span>üåê</span> <span class="lang-th">‡πÄ‡∏ß‡πá‡∏ö & ‡πÅ‡∏≠‡∏õ</span><span class="lang-en hidden">Web & App</span>
            </button>
            <button onclick="switchTab('sys-data')" id="btn-sys-data" class="tab-btn px-5 py-2.5 rounded-full border border-slate-300 bg-white text-slate-600 font-semibold hover:bg-slate-100 transition-all shadow-sm flex items-center gap-2">
                <span>üíæ</span> <span class="lang-th">‡∏£‡∏∞‡∏ö‡∏ö & ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span><span class="lang-en hidden">System & Data</span>
            </button>
            <button onclick="switchTab('net-infra')" id="btn-net-infra" class="tab-btn px-5 py-2.5 rounded-full border border-slate-300 bg-white text-slate-600 font-semibold hover:bg-slate-100 transition-all shadow-sm flex items-center gap-2">
                <span>üîå</span> <span class="lang-th">‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ & ‡∏≠‡∏¥‡∏ô‡∏ü‡∏£‡∏≤</span><span class="lang-en hidden">Network & Infra</span>
            </button>
            <button onclick="switchTab('admin-pro')" id="btn-admin-pro" class="tab-btn px-5 py-2.5 rounded-full border border-slate-300 bg-white text-slate-600 font-semibold hover:bg-slate-100 transition-all shadow-sm flex items-center gap-2">
                <span>üöÄ</span> <span class="lang-th">Pro Admin</span><span class="lang-en hidden">Pro Admin</span>
            </button>
            <button onclick="switchTab('versions')" id="btn-versions" class="tab-btn px-5 py-2.5 rounded-full border border-slate-300 bg-white text-slate-600 font-semibold hover:bg-slate-100 transition-all shadow-sm flex items-center gap-2">
                <span>üì¶</span> <span class="lang-th">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô</span><span class="lang-en hidden">Versions</span>
            </button>
        </div>

        <!-- TAB 1: WEB & APP -->
        <div id="web-app" class="tab-content block space-y-8">
            <section class="category-section" data-category="HTTP Status Codes">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-green-100 rounded-lg text-green-600"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">HTTP Status Codes</h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/6">Code</th><th class="p-4 w-1/6">Responsibility</th><th class="p-4 w-1/3">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                            <tbody id="tbody-http" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <section class="category-section" data-category="IIS & ASP.NET Application">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-indigo-100 rounded-lg text-indigo-600"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">IIS & ASP.NET Application</h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Error / Message</th><th class="p-4 w-1/5">Responsibility</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                            <tbody id="tbody-iis" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section class="category-section" data-category="IIS Application Pool Strategy">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-blue-600 rounded-lg text-white"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">IIS Application Pool Strategy</h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Error / Symptom</th><th class="p-4 w-1/5">Responsibility</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                            <tbody id="tbody-apppool" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                    </div>
                </div>
            </section>

             <section class="category-section" data-category="Browser & SSL/TLS">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-pink-600 rounded-lg text-white"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">Browser & SSL/TLS</h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Error</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                            <tbody id="tbody-browser" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                    </div>
                </div>
            </section>

             <section class="category-section" data-category="Libraries & MS Office">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-teal-100 rounded-lg text-teal-600"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">Libraries & MS Office</h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                     <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Error</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                            <tbody id="tbody-lib" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>

        <!-- TAB 2: SYSTEM & DATA -->
        <div id="sys-data" class="tab-content hidden space-y-8">
            <section class="category-section" data-category="Identity (AD, Azure, IIS Auth)">
                 <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-violet-100 rounded-lg text-violet-600"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">Identity (AD, Azure, IIS Auth)</h2>
                </div>
                 <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                             <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Error</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                             <tbody id="tbody-identity" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                    </div>
                 </div>
            </section>

             <section class="category-section" data-category="Database (SQL Server)">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-yellow-100 rounded-lg text-yellow-600"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">Database (SQL Server)</h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                     <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                             <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Error</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                             <tbody id="tbody-db" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                     </div>
                </div>
            </section>

            <section class="category-section" data-category="File System & Permissions">
                 <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-amber-600 rounded-lg text-white"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">File System & Permissions</h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                     <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                             <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Error</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                             <tbody id="tbody-files" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                     </div>
                </div>
            </section>

            <section class="category-section" data-category="Storage & System Services">
                 <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-slate-500 rounded-lg text-white"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">Storage & System Services</h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                     <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                             <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Error</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                             <tbody id="tbody-storage" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                     </div>
                </div>
            </section>

             <section class="category-section">
                <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-blue-800 mb-4">üîë ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á User Account (‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÑ‡∏´‡∏ô‡∏î‡∏µ?)</h3>
                    <ul class="space-y-3 text-slate-700">
                        <li><strong>IIS AppPool\[Name]:</strong> <span class="text-green-600 font-bold">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Web App ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡πÅ‡∏¢‡∏Å‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô</li>
                        <li><strong>IUSR:</strong> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå "‡∏Ñ‡∏ô‡∏ô‡∏≠‡∏Å" ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö (Public Read)</li>
                        <li><strong>Network Service:</strong> ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ App ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Server ‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏ô Domain</li>
                        <li><strong>Local System:</strong> <span class="text-red-600 font-bold">‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ!</span> ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö</li>
                    </ul>
                </div>
            </section>
        </div>

        <!-- TAB 3: NETWORK & INFRA -->
        <div id="net-infra" class="tab-content hidden space-y-8">
             <section class="category-section" data-category="Network, Port & SMTP">
                 <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-gray-200 rounded-lg text-gray-600"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">Network, Port & SMTP</h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                     <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                             <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Error</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                             <tbody id="tbody-network" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                     </div>
                </div>
            </section>

             <section class="category-section" data-category="Email SMTP (Gmail/Outlook)">
                 <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-red-100 rounded-lg text-red-600"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">Email SMTP (Gmail/Outlook)</h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                     <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                             <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Error</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                             <tbody id="tbody-email" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                     </div>
                </div>
            </section>

             <section class="category-section" data-category="Printer & RPC">
                 <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-pink-100 rounded-lg text-pink-600"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">Printer & RPC</h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                     <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                             <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Error</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Solution</th></tr></thead>
                             <tbody id="tbody-printer" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                     </div>
                </div>
            </section>
        </div>

        <!-- NEW TAB: Pro Admin (Cheatsheets) -->
        <div id="admin-pro" class="tab-content hidden space-y-8">
            <!-- Log Files -->
            <section class="category-section" data-category="Log File Locations">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-rose-600 rounded-lg text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">
                        <span class="lang-th">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå Log (Log File Locations)</span>
                        <span class="lang-en hidden">Log File Locations Map</span>
                    </h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                     <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                             <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Log Type</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Path / Location</th></tr></thead>
                             <tbody id="tbody-logfiles" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                     </div>
                </div>
            </section>

             <!-- Connectivity Tricks -->
            <section class="category-section" data-category="Connectivity Tricks">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-sky-600 rounded-lg text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">
                        <span class="lang-th">‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ (No Code)</span>
                        <span class="lang-en hidden">Connectivity Tricks (No Code)</span>
                    </h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                     <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                             <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Technique</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">How-to</th></tr></thead>
                             <tbody id="tbody-connectivity" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                     </div>
                </div>
            </section>

             <!-- Performance Counters -->
            <section class="category-section" data-category="Performance Counters">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-fuchsia-600 rounded-lg text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">
                        <span class="lang-th">‡∏Ñ‡πà‡∏≤ Performance ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π (Counters)</span>
                        <span class="lang-en hidden">Key Performance Counters</span>
                    </h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                     <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                             <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider"><th class="p-4 w-1/4">Counter Name</th><th class="p-4 w-1/5">Role</th><th class="p-4 w-1/4">Description</th><th class="p-4 w-1/3">Threshold (‡∏Ñ‡πà‡∏≤‡∏ß‡∏¥‡∏Å‡∏§‡∏ï)</th></tr></thead>
                             <tbody id="tbody-perf" class="divide-y divide-slate-100 text-sm md:text-base search-target"></tbody>
                        </table>
                     </div>
                </div>
            </section>
        </div>

        <!-- NEW TAB: Versions & Compatibility (Static Content with Lang Support) -->
        <div id="versions" class="tab-content hidden space-y-8">
            <!-- SQL Server -->
            <section class="category-section">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-blue-600 rounded-lg text-white"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">
                        <span class="lang-th">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô Microsoft SQL Server</span>
                        <span class="lang-en hidden">Microsoft SQL Server Versions</span>
                    </h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                    <table class="w-full text-left border-collapse ver-table">
                        <thead><tr class="bg-slate-50 text-slate-700">
                            <th class="p-4"><span class="lang-th">‡∏£‡∏∏‡πà‡∏ô SQL</span><span class="lang-en hidden">SQL Version</span></th>
                            <th class="p-4"><span class="lang-th">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô</span><span class="lang-en hidden">Internal Ver.</span></th>
                            <th class="p-4"><span class="lang-th">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</span><span class="lang-en hidden">Status</span></th>
                            <th class="p-4"><span class="lang-th">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ / ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ</span><span class="lang-en hidden">Note / Compatibility</span></th>
                        </tr></thead>
                        <tbody class="divide-y divide-slate-100 text-sm">
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">SQL Server 2022</td><td class="p-4">16.0</td><td class="p-4"><span class="ver-badge badge-green">Supported</span></td><td class="p-4"><span class="lang-th">‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Windows Server 2016+</span><span class="lang-en hidden">Requires Windows Server 2016+</span></td></tr>
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">SQL Server 2019</td><td class="p-4">15.0</td><td class="p-4"><span class="ver-badge badge-green">Supported</span></td><td class="p-4"><span class="lang-th">‡∏£‡∏∏‡πà‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏°‡∏µ Big Data Clusters</span><span class="lang-en hidden">Last version with Big Data Clusters</span></td></tr>
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">SQL Server 2017</td><td class="p-4">14.0</td><td class="p-4"><span class="ver-badge badge-yellow">Extended</span></td><td class="p-4"><span class="lang-th">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Linux</span><span class="lang-en hidden">First version on Linux</span></td></tr>
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">SQL Server 2016</td><td class="p-4">13.0</td><td class="p-4"><span class="ver-badge badge-yellow">Extended</span></td><td class="p-4"><span class="lang-th">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏°‡∏µ Query Store</span><span class="lang-en hidden">Introduced Query Store</span></td></tr>
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">SQL Server 2014</td><td class="p-4">12.0</td><td class="p-4"><span class="ver-badge badge-red">End of Life</span></td><td class="p-4"><span class="lang-th">‡∏´‡∏°‡∏î‡∏£‡∏∞‡∏¢‡∏∞ Support (‡∏Å.‡∏Ñ. 2024)</span><span class="lang-en hidden">Out of support (July 2024)</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

             <!-- Windows Server -->
            <section class="category-section">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-indigo-600 rounded-lg text-white"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">
                        <span class="lang-th">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô Windows Server</span>
                        <span class="lang-en hidden">Windows Server Versions</span>
                    </h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                    <table class="w-full text-left border-collapse ver-table">
                        <thead><tr class="bg-slate-50 text-slate-700">
                            <th class="p-4"><span class="lang-th">‡∏£‡∏∏‡πà‡∏ô OS</span><span class="lang-en hidden">OS Version</span></th>
                            <th class="p-4"><span class="lang-th">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç Build</span><span class="lang-en hidden">Build Base</span></th>
                            <th class="p-4"><span class="lang-th">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</span><span class="lang-en hidden">Status</span></th>
                            <th class="p-4"><span class="lang-th">‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô / ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ</span><span class="lang-en hidden">Key Compatibility</span></th>
                        </tr></thead>
                        <tbody class="divide-y divide-slate-100 text-sm">
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">Windows Server 2022</td><td class="p-4">20348</td><td class="p-4"><span class="ver-badge badge-green">Mainstream</span></td><td class="p-4"><span class="lang-th">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö TLS 1.3 ‡πÇ‡∏î‡∏¢ default, ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö SQL 2022</span><span class="lang-en hidden">Support TLS 1.3 by default. Best for SQL 2022.</span></td></tr>
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">Windows Server 2019</td><td class="p-4">17763</td><td class="p-4"><span class="ver-badge badge-green">Mainstream</span></td><td class="p-4"><span class="lang-th">‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö App ‡πÄ‡∏Å‡πà‡∏≤‡πÜ ‡πÑ‡∏î‡πâ‡∏î‡∏µ</span><span class="lang-en hidden">Stable standard. Supports most legacy apps.</span></td></tr>
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">Windows Server 2016</td><td class="p-4">14393</td><td class="p-4"><span class="ver-badge badge-yellow">Extended</span></td><td class="p-4"><span class="lang-th">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ä‡πâ‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà</span><span class="lang-en hidden">Slower Windows Update mechanism.</span></td></tr>
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">Windows Server 2012 R2</td><td class="p-4">9600</td><td class="p-4"><span class="ver-badge badge-red">End of Life</span></td><td class="p-4"><span class="lang-th">‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß (‡∏ï.‡∏Ñ. 2023) ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á</span><span class="lang-en hidden">EOL Oct 2023. Risk of no security updates.</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- MS Office -->
            <section class="category-section">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-orange-500 rounded-lg text-white"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">
                        <span class="lang-th">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ Microsoft Office</span>
                        <span class="lang-en hidden">Microsoft Office Compatibility</span>
                    </h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                    <table class="w-full text-left border-collapse ver-table">
                        <thead><tr class="bg-slate-50 text-slate-700">
                            <th class="p-4"><span class="lang-th">‡∏£‡∏∏‡πà‡∏ô Office</span><span class="lang-en hidden">Office Version</span></th>
                            <th class="p-4"><span class="lang-th">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ O365</span><span class="lang-en hidden">O365 Connect</span></th>
                            <th class="p-4"><span class="lang-th">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</span><span class="lang-en hidden">Status</span></th>
                            <th class="p-4"><span class="lang-th">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</span><span class="lang-en hidden">Note</span></th>
                        </tr></thead>
                        <tbody class="divide-y divide-slate-100 text-sm">
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">Microsoft 365 (Apps)</td><td class="p-4 text-green-600 font-bold">Full Support</td><td class="p-4"><span class="ver-badge badge-green">Current</span></td><td class="p-4"><span class="lang-th">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤ (Subscription)</span><span class="lang-en hidden">Always updated. Subscription based.</span></td></tr>
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">Office LTSC 2021</td><td class="p-4 text-green-600 font-bold">Supported</td><td class="p-4"><span class="ver-badge badge-green">Supported</span></td><td class="p-4"><span class="lang-th">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏î (Perpetual)</span><span class="lang-en hidden">Perpetual license version.</span></td></tr>
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">Office 2016/2019</td><td class="p-4 text-yellow-600 font-bold">Limited</td><td class="p-4"><span class="ver-badge badge-yellow">Extended</span></td><td class="p-4"><span class="lang-th">‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏±‡∏ö O365 Services</span><span class="lang-en hidden">Might have issues connecting to O365.</span></td></tr>
                            <tr class="hover:bg-slate-50"><td class="p-4 font-bold">Office 2013</td><td class="p-4 text-red-600 font-bold">Blocked</td><td class="p-4"><span class="ver-badge badge-red">End of Life</span></td><td class="p-4"><span class="lang-th">‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ O365</span><span class="lang-en hidden">Cannot connect to O365 services.</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

             <!-- Free vs Paid Section -->
            <section class="category-section">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-emerald-600 rounded-lg text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    </div>
                    <h2 class="text-2xl font-bold text-slate-800">
                        <span class="lang-th">‡∏Ç‡∏≠‡∏á‡∏ü‡∏£‡∏µ vs ‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏á‡∏¥‡∏ô (‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î)</span>
                        <span class="lang-en hidden">Free vs. Paid Editions</span>
                    </h2>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                    <table class="w-full text-left border-collapse ver-table">
                        <thead>
                            <tr class="bg-slate-50 text-slate-700">
                                <th class="p-4"><span class="lang-th">‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå</span><span class="lang-en hidden">Software</span></th>
                                <th class="p-4"><span class="lang-th">‡∏£‡∏∏‡πà‡∏ô‡∏ü‡∏£‡∏µ</span><span class="lang-en hidden">Free Edition</span></th>
                                <th class="p-4"><span class="lang-th">‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</span><span class="lang-en hidden">Limitations</span></th>
                                <th class="p-4"><span class="lang-th">‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö</span><span class="lang-en hidden">Use Case</span></th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-100 text-sm">
                            <tr class="hover:bg-slate-50">
                                <td class="p-4 font-bold">SQL Server</td>
                                <td class="p-4"><span class="ver-badge badge-green">Express</span></td>
                                <td class="p-4 text-slate-600">
                                    <span class="lang-th">‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Max 10GB, RAM 1.4GB, ‡πÑ‡∏°‡πà‡∏°‡∏µ SQL Agent</span>
                                    <span class="lang-en hidden">Max DB Size 10GB, RAM 1.4GB, 4 Cores, No SQL Agent</span>
                                </td>
                                <td class="p-4">Small Apps / Dev</td>
                            </tr>
                            <tr class="hover:bg-slate-50">
                                <td class="p-4 font-bold">Windows Server</td>
                                <td class="p-4"><span class="ver-badge badge-yellow">Evaluation</span></td>
                                <td class="p-4 text-slate-600">
                                    <span class="lang-th">‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ 180 ‡∏ß‡∏±‡∏ô, ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</span>
                                    <span class="lang-en hidden">180 days limit, Auto-shutdown when expired</span>
                                </td>
                                <td class="p-4">Testing / PoC</td>
                            </tr>
                             <tr class="hover:bg-slate-50">
                                <td class="p-4 font-bold">Visual Studio</td>
                                <td class="p-4"><span class="ver-badge badge-green">Community</span></td>
                                <td class="p-4 text-slate-600">
                                    <span class="lang-th">‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà (>250 PC)</span>
                                    <span class="lang-en hidden">Not for Enterprise (>250 PCs or >$1M Revenue)</span>
                                </td>
                                <td class="p-4">Individual / Student</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

        <!-- TAB 4: TOOLS -->
        <div id="tools" class="tab-content hidden space-y-8">
            <section class="category-section" data-category="Basic Troubleshooting Tools">
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-slate-300">
                    <div class="p-2 bg-slate-700 rounded-lg text-white"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg></div>
                    <h2 class="text-2xl font-bold text-slate-800">
                        <span class="lang-th">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (CMD)</span>
                        <span class="lang-en hidden">Basic Troubleshooting Tools (CMD)</span>
                    </h2>
                </div>
                <div id="tools-container">
                    <!-- Tools content will be rendered here -->
                </div>
            </section>
        </div>

    </main>
    
    <!-- Modal for Adding Entry (Updated to handle new schema) -->
    <div id="addModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>
        <div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto">
            <div class="modal-content py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3">
                    <p class="text-2xl font-bold text-slate-800">
                        <span class="lang-th">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Error ‡πÉ‡∏´‡∏°‡πà</span>
                        <span class="lang-en hidden">Add New Error</span>
                    </p>
                    <div class="modal-close cursor-pointer z-50" onclick="toggleModal('addModal')">
                        <svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path></svg>
                    </div>
                </div>
                <form id="addErrorForm" onsubmit="handleAddNew(event)">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">
                             <span class="lang-th">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà (Category)</span><span class="lang-en hidden">Category</span>
                        </label>
                        <select id="newCategory" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                            <option value="HTTP Status Codes">HTTP Status Codes</option>
                            <option value="IIS & ASP.NET Application">IIS & ASP.NET Application</option>
                            <option value="IIS Application Pool Strategy">IIS Application Pool Strategy</option>
                            <option value="Browser & SSL/TLS">Browser & SSL/TLS</option>
                            <option value="Libraries & MS Office">Libraries & MS Office</option>
                            <option value="Identity (AD, Azure, IIS Auth)">Identity (AD, Azure, IIS Auth)</option>
                            <option value="Database (SQL Server)">Database (SQL Server)</option>
                            <option value="File System & Permissions">File System & Permissions</option>
                            <option value="Storage & System Services">Storage & System Services</option>
                            <option value="Network, Port & SMTP">Network, Port & SMTP</option>
                            <option value="Email SMTP (Gmail/Outlook)">Email SMTP (Gmail/Outlook)</option>
                            <option value="Printer & RPC">Printer & RPC</option>
                             <option value="Log File Locations">Log File Locations</option>
                            <option value="Connectivity Tricks">Connectivity Tricks</option>
                            <option value="Performance Counters">Performance Counters</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">
                            <span class="lang-th">‡∏£‡∏´‡∏±‡∏™ Error / ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</span><span class="lang-en hidden">Code / Message</span>
                        </label>
                        <input id="newCode" type="text" required class="shadow border rounded w-full py-2 px-3 text-gray-700 focus:outline-none focus:shadow-outline">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">
                            <span class="lang-th">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</span><span class="lang-en hidden">Role</span>
                        </label>
                        <select id="newRole" class="shadow border rounded w-full py-2 px-3 text-gray-700">
                             <option value="SERVER ADMIN">SERVER ADMIN</option>
                            <option value="APP DEVELOPER">APP DEVELOPER</option>
                            <option value="SHARED">SHARED / BOTH</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">
                            <span class="lang-th">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (‡πÑ‡∏ó‡∏¢)</span><span class="lang-en hidden">Description (TH)</span>
                        </label>
                        <textarea id="newDescTh" required class="shadow border rounded w-full py-2 px-3 text-gray-700" rows="2"></textarea>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">
                             <span class="lang-th">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©)</span><span class="lang-en hidden">Description (EN)</span>
                        </label>
                        <textarea id="newDescEn" required class="shadow border rounded w-full py-2 px-3 text-gray-700" rows="2"></textarea>
                    </div>
                     <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">
                             <span class="lang-th">‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡πÑ‡∏ó‡∏¢)</span><span class="lang-en hidden">Solution (TH)</span>
                        </label>
                        <textarea id="newSolTh" required class="shadow border rounded w-full py-2 px-3 text-gray-700" rows="2"></textarea>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">
                            <span class="lang-th">‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©)</span><span class="lang-en hidden">Solution (EN)</span>
                        </label>
                        <textarea id="newSolEn" required class="shadow border rounded w-full py-2 px-3 text-gray-700" rows="2"></textarea>
                    </div>
                    <div class="flex justify-end pt-2">
                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 mr-2">
                            <span class="lang-th">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span><span class="lang-en hidden">Save</span>
                        </button>
                        <button type="button" onclick="toggleModal('addModal')" class="px-4 py-2 bg-transparent text-indigo-500 hover:text-indigo-400">
                             <span class="lang-th">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</span><span class="lang-en hidden">Cancel</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal for AI Analysis -->
    <div id="aiModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-70"></div>
        <div class="modal-container bg-white w-11/12 md:max-w-2xl mx-auto rounded shadow-lg z-50 overflow-y-auto max-h-[90vh]">
            <div class="modal-content py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3 border-b border-gray-200">
                    <p class="text-2xl font-bold text-slate-800 flex items-center gap-2">
                        <span>‚ú®</span>
                        <span class="lang-th">‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</span>
                        <span class="lang-en hidden">AI Smart Troubleshooter</span>
                    </p>
                    <div class="modal-close cursor-pointer z-50" onclick="toggleModal('aiModal')">
                        <svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path></svg>
                    </div>
                </div>
                
                <div class="py-4">
                    <p class="mb-2 text-slate-600 text-sm">
                        <span class="lang-th">‡∏ß‡∏≤‡∏á Error Log, Code, ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏û‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á AI ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì</span>
                        <span class="lang-en hidden">Paste your Error Log, Code, or describe the symptoms below. AI will analyze the cause and suggest solutions.</span>
                    </p>
                    <textarea id="aiInput" class="w-full border-2 border-slate-300 rounded-lg p-3 h-32 focus:outline-none focus:border-violet-500 font-mono text-sm" placeholder="e.g., Error 500 when accessing /api/login, IIS logs show 'module not found'..."></textarea>
                    
                    <div class="flex justify-end mt-3">
                         <button onclick="handleAiAnalyze()" class="bg-gradient-to-r from-violet-600 to-indigo-600 hover:from-violet-700 hover:to-indigo-700 text-white px-5 py-2.5 rounded-lg shadow-md font-medium transition-all flex items-center gap-2">
                             <span class="lang-th">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤</span><span class="lang-en hidden">Analyze Issue</span> ‚ú®
                         </button>
                    </div>
                </div>

                <!-- AI Output Section -->
                <div class="border-t border-gray-200 pt-4 mt-2">
                    <div id="aiLoading" class="hidden flex flex-col items-center justify-center py-8">
                        <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-violet-600 mb-3"></div>
                        <p class="text-violet-600 font-medium animate-pulse">
                            <span class="lang-th">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</span>
                            <span class="lang-en hidden">Analyzing data...</span>
                        </p>
                    </div>
                    
                    <div id="aiOutput" class="hidden bg-slate-50 rounded-lg p-4 border border-slate-200 text-slate-700 text-sm leading-relaxed ai-response overflow-y-auto max-h-[40vh]">
                        <!-- Results will appear here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-white border-t border-slate-200 py-8">
        <div class="max-w-7xl mx-auto px-4 text-center text-slate-500 text-sm">
            <p>&copy; 2025 Server Troubleshooting Guide (Pro Version). Powered by LocalStorage & Gemini AI.</p>
        </div>
    </footer>

    <!-- MAIN SCRIPT -->
    <script>
        // API Key for Gemini
        const apiKey = ""; 

        // --- 1. INITIAL DATA (Updated with EN/TH) ---
        const defaultData = [
            // HTTP Status
            { cat: "HTTP Status Codes", code: "500", role: "APP DEVELOPER", desc_th: "‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå (‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î)", desc_en: "Internal Server Error (Code Error)", sol_th: "‡∏î‡∏π Log ‡πÑ‡∏ü‡∏•‡πå / ‡πÄ‡∏õ‡∏¥‡∏î `customErrors=Off` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î", sol_en: "Check Log file / Set `customErrors=Off`" },
            { cat: "HTTP Status Codes", code: "503", role: "SERVER ADMIN", desc_th: "App Pool ‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ Server ‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏´‡∏ß", desc_en: "App Pool Stopped or Server Overload", sol_th: "‡πÄ‡∏£‡∏¥‡πà‡∏° App Pool ‡πÉ‡∏ô IIS / ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö RAM, CPU ‡∏Ç‡∏≠‡∏á Server", sol_en: "Start App Pool / Check RAM, CPU" },
            { cat: "HTTP Status Codes", code: "403", role: "SERVER ADMIN", desc_th: "‡∏ñ‡∏π‡∏Å‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á (Forbidden) ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå", desc_en: "Forbidden (Access Denied)", sol_th: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Read/List ‡πÉ‡∏´‡πâ User `IIS_IUSRS` ‡∏ó‡∏µ‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå", sol_en: "Add Read/List permission for `IIS_IUSRS`" },
            { cat: "HTTP Status Codes", code: "404", role: "APP DEVELOPER", desc_th: "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏£‡∏∑‡∏≠ URL ‡∏´‡∏≤‡∏¢)", desc_en: "Not Found (File/URL missing)", sol_th: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô URL, Config ‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏´‡∏°", sol_en: "Check URL Routing or File existence" },
            { cat: "HTTP Status Codes", code: "502", role: "SERVER ADMIN", desc_th: "‡πÄ‡∏Å‡∏ï‡πÄ‡∏ß‡∏¢‡πå‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î (Proxy Error)", desc_en: "Bad Gateway (Proxy Error)", sol_th: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Service ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏° / ‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó App Pool", sol_en: "Check Backend Service / Restart App Pool" },

            // IIS
            { cat: "IIS & ASP.NET Application", code: "Object reference not set...", role: "APP DEVELOPER", desc_th: "‡πÇ‡∏Ñ‡πâ‡∏î: ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ñ‡∏∂‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤ (Null)", desc_en: "Code: Null Reference Exception", sol_th: "‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `!= null` ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", sol_en: "Fix Code: Add `!= null` check" },
            { cat: "IIS & ASP.NET Application", code: "System.IO.FileNotFound", role: "APP DEVELOPER", desc_th: "‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå DLL ‡∏´‡∏£‡∏∑‡∏≠ Config ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠", desc_en: "DLL/Config file not found", sol_th: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `bin` ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Path", sol_en: "Check files in `bin`, Verify Path" },
            { cat: "IIS & ASP.NET Application", code: "Configuration Errors", role: "APP DEVELOPER", desc_th: "‡πÑ‡∏ü‡∏•‡πå Web.config ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ú‡∏¥‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á", desc_en: "Web.config syntax error", sol_th: "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á XML ‡πÉ‡∏ô `web.config` ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á", sol_en: "Fix XML Syntax in `web.config`" },
            { cat: "IIS & ASP.NET Application", code: "OutOfMemoryException", role: "SHARED", desc_th: "‡πÅ‡∏£‡∏°‡πÑ‡∏°‡πà‡∏û‡∏≠ / ‡πÇ‡∏Ñ‡πâ‡∏î‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÅ‡∏£‡∏°‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡∏Ñ‡∏∑‡∏ô", desc_en: "Out of RAM / Memory Leak", sol_th: "‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï IIS / ‡∏´‡∏≤‡∏à‡∏∏‡∏î Memory Leak ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î / ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏°", sol_en: "IISReset / Fix Memory Leak / Add RAM" },
            { cat: "IIS & ASP.NET Application", code: "0x8007000B", role: "SHARED", desc_th: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 32-bit ‡πÅ‡∏•‡∏∞ 64-bit", desc_en: "32-bit vs 64-bit mismatch", sol_th: "‡πÉ‡∏ô IIS > ‡πÄ‡∏õ‡∏¥‡∏î Enable 32-Bit = True", sol_en: "IIS > Enable 32-Bit = True" },
            { cat: "IIS & ASP.NET Application", code: "Max request length exceeded", role: "APP DEVELOPER", desc_th: "‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î (4MB)", desc_en: "Upload size exceeded (4MB)", sol_th: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤ `maxRequestLength` ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Config", sol_en: "Increase `maxRequestLength` in Config" },

             // IIS App Pool Strategy
            { cat: "IIS Application Pool Strategy", code: "503 App Pool Stopped", role: "SERVER ADMIN", desc_th: "App Pool ‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏≠‡∏á (‡πÅ‡∏Ñ‡∏£‡∏ä)", desc_en: "App Pool Auto-Stopped (Crash)", sol_th: "1. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà 2. ‡∏î‡∏π Event Viewer ‡∏´‡∏≤‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏", sol_en: "1. Start again 2. Check Event Viewer" },
            { cat: "IIS Application Pool Strategy", code: "Identity Logon Failure", role: "SERVER ADMIN", desc_th: "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Identity ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Å", desc_en: "Identity Password Changed/Locked", sol_th: "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï User/Pass ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô Advanced Settings", sol_en: "Update User/Pass in Advanced Settings" },
            { cat: "IIS Application Pool Strategy", code: "Rapid Fail Protection", role: "APP DEVELOPER", desc_th: "‡∏•‡πà‡∏°‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô 5 ‡∏ô‡∏≤‡∏ó‡∏µ", desc_en: "Crashed 5 times in 5 mins", sol_th: "‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏±‡∏á‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏° Pool ‡πÉ‡∏´‡∏°‡πà", sol_en: "Fix crashing code before Starting Pool" },
            { cat: "IIS Application Pool Strategy", code: "Session Recycling", role: "SERVER ADMIN", desc_th: "Session ‡∏´‡∏•‡∏∏‡∏î‡∏ö‡πà‡∏≠‡∏¢ (‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô 20 ‡∏ô‡∏≤‡∏ó‡∏µ)", desc_en: "Session lost (Idle 20min)", sol_th: "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Idle Time-out = 0", sol_en: "Set Idle Time-out = 0" },
            { cat: "IIS Application Pool Strategy", code: "High Memory (w3wp)", role: "SHARED", desc_th: "‡∏Å‡∏¥‡∏ô‡πÅ‡∏£‡∏°‡πÑ‡∏°‡πà‡∏Ñ‡∏∑‡∏ô (Memory Leak)", desc_en: "High Memory Usage (Leak)", sol_th: "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Private Memory Limit ‡πÉ‡∏´‡πâ‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥", sol_en: "Set Private Memory Limit to Recycle" },
            { cat: "IIS Application Pool Strategy", code: "500.13 Server Too Busy", role: "SERVER ADMIN", desc_th: "‡∏Ñ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏¥‡∏ß‡∏à‡∏∞‡∏£‡∏±‡∏ö‡πÑ‡∏´‡∏ß", desc_en: "High Traffic / Queue Full", sol_th: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤ Queue Length ‡πÉ‡∏ô Advanced Settings", sol_en: "Increase Queue Length" },

            // Browser SSL
            { cat: "Browser & SSL/TLS", code: "Blocked by CORS policy", role: "SHARED", desc_th: "‡∏ï‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡πâ‡∏≤‡∏°‡πÇ‡∏î‡πÄ‡∏°‡∏ô", desc_en: "Cross-Domain Security Block", sol_th: "‡πÄ‡∏û‡∏¥‡πà‡∏° Header Access-Control-Allow-Origin ‡∏ó‡∏µ‡πà‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå", sol_en: "Add Access-Control-Allow-Origin Header" },
            { cat: "Browser & SSL/TLS", code: "Mixed Content", role: "APP DEVELOPER", desc_th: "‡∏´‡∏ô‡πâ‡∏≤ HTTPS ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• HTTP (‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)", desc_en: "HTTPS loading HTTP resources", sol_th: "‡πÅ‡∏Å‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô `https://` ‡∏´‡∏£‡∏∑‡∏≠ `//`", sol_en: "Change links to `https://` or `//`" },
            { cat: "Browser & SSL/TLS", code: "ERR_CERT_AUTHORITY_INVALID", role: "SERVER ADMIN", desc_th: "‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠ / ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏", desc_en: "Certificate Invalid / Expired", sol_th: "‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏ SSL / ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Root CA", sol_en: "Renew SSL / Install Root CA" },
            { cat: "Browser & SSL/TLS", code: "ERR_TOO_MANY_REDIRECTS", role: "APP DEVELOPER", desc_th: "‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ß‡∏ô‡∏ã‡πâ‡∏≥‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏ö", desc_en: "Infinite Redirect Loop", sol_th: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Logic ‡∏Å‡∏≤‡∏£ Redirect / URL Rewrite", sol_en: "Check Redirect Logic / URL Rewrite" },

            // Libraries
            { cat: "Libraries & MS Office", code: "DllNotFoundException", role: "SHARED", desc_th: "‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå .dll ‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠", desc_en: "Missing external .dll", sol_th: "‡∏•‡∏á VC++ Redist / ‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ DLL ‡∏•‡∏á bin", sol_en: "Install VC++ Redist / Copy DLL to bin" },
            { cat: "Libraries & MS Office", code: "GDI+ Generic Error", role: "APP DEVELOPER", desc_th: "‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å", desc_en: "Memory Lock in Graphics", sol_th: "‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î: ‡πÉ‡∏ä‡πâ `using` ‡∏´‡∏£‡∏∑‡∏≠ `.Dispose()`", sol_en: "Fix Code: Use `using` or `.Dispose()`" },
            { cat: "Libraries & MS Office", code: "Font not found", role: "SERVER ADMIN", desc_th: "‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏", desc_en: "Font missing on Server", sol_th: "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏•‡∏á Server > ‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó", sol_en: "Install Font on Server > Restart" },
            { cat: "Libraries & MS Office", code: "0x80040154 Class not registered", role: "SERVER ADMIN", desc_th: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° Office / Bit ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á", desc_en: "Missing Office / Bit mismatch", sol_th: "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Office / Access Runtime (x86/x64)", sol_en: "Install Office / Access Runtime (x86/x64)" },
            { cat: "Libraries & MS Office", code: "0x80070005 Access is denied", role: "SERVER ADMIN", desc_th: "IIS User ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏õ‡∏¥‡∏î Excel", desc_en: "IIS User cannot open Excel", sol_th: "‡πÉ‡∏ä‡πâ dcomcnfg > ‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå IIS User", sol_en: "dcomcnfg > Grant permission to IIS User" },
            { cat: "Libraries & MS Office", code: "Call was rejected by callee", role: "SHARED", desc_th: "‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° Office ‡∏Ñ‡πâ‡∏≤‡∏á (Popup/Busy)", desc_en: "Office App Hanging/Busy", sol_th: "Task Manager > End Task Excel.exe", sol_en: "Task Manager > End Task Excel.exe" },

             // Identity
            { cat: "Identity (AD, Azure, IIS Auth)", code: "0x8009030C", role: "SERVER ADMIN", desc_th: "‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Å ‡∏´‡∏£‡∏∑‡∏≠ ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏¥‡∏î", desc_en: "Account Locked / Wrong Password", sol_th: "‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÉ‡∏ô AD / ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô", sol_en: "Unlock in AD / Reset Password" },
            { cat: "Identity (AD, Azure, IIS Auth)", code: "Clock skew too great", role: "SERVER ADMIN", desc_th: "‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏≠‡∏á Server ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö AD", desc_en: "Server time mismatch with AD", sol_th: "CMD: `w32tm /resync`", sol_en: "CMD: `w32tm /resync`" },
            { cat: "Identity (AD, Azure, IIS Auth)", code: "LDAP: Server not operational", role: "SERVER ADMIN", desc_th: "‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Domain Controller ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ", desc_en: "Cannot contact Domain Controller", sol_th: "‡πÄ‡∏ä‡πá‡∏Ñ DNS / Ping DC", sol_en: "Check DNS / Ping DC" },
            { cat: "Identity (AD, Azure, IIS Auth)", code: "AADSTS50011 Reply URL", role: "APP DEVELOPER", desc_th: "Azure Redirect URI ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô", desc_en: "Azure Redirect URI mismatch", sol_th: "‡πÅ‡∏Å‡πâ URI ‡πÉ‡∏ô Azure Portal ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î", sol_en: "Fix URI in Azure Portal to match Code" },
            { cat: "Identity (AD, Azure, IIS Auth)", code: "AADSTS50076 MFA Required", role: "SHARED", desc_th: "‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô MFA (‡∏ï‡∏¥‡∏î Policy)", desc_en: "MFA Required (Policy)", sol_th: "‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏≠‡∏õ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö OAuth2", sol_en: "Update App to support OAuth2" },
            { cat: "Identity (AD, Azure, IIS Auth)", code: "AADSTS70002 Secret expired", role: "APP DEVELOPER", desc_th: "Client Secret ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏", desc_en: "Client Secret Expired", sol_th: "‡∏™‡∏£‡πâ‡∏≤‡∏á Secret ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô Azure Portal", sol_en: "Azure Portal > Create New Secret" },
            { cat: "Identity (AD, Azure, IIS Auth)", code: "HTTP 401.1 Logon Failed", role: "SHARED", desc_th: "User/Pass ‡∏ú‡∏¥‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå", desc_en: "Wrong User/Pass or No Permission", sol_th: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö User/Pass, NTFS Permission", sol_en: "Check User/Pass, NTFS Permission" },
             { cat: "Identity (AD, Azure, IIS Auth)", code: "HTTP 401.2 Config", role: "SERVER ADMIN", desc_th: "‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô", desc_en: "Auth Method Disabled", sol_th: "IIS > ‡πÄ‡∏õ‡∏¥‡∏î Anonymous/Windows Auth", sol_en: "IIS > Enable Anonymous/Windows Auth" },
             { cat: "Identity (AD, Azure, IIS Auth)", code: "HTTP 401 Challenge Loop", role: "SERVER ADMIN", desc_th: "‡∏ï‡∏¥‡∏î NTLM Loopback Check", desc_en: "NTLM Loopback Check", sol_th: "RegEdit: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ `DisableLoopbackCheck`=1", sol_en: "RegEdit: `DisableLoopbackCheck`=1" },

            // Database
            { cat: "Database (SQL Server)", code: "Error: 26", role: "SERVER ADMIN", desc_th: "‡∏´‡∏≤ Database Server ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠", desc_en: "Cannot locate Database Server", sol_th: "‡πÄ‡∏ä‡πá‡∏Ñ Service SQL, IP, Firewall", sol_en: "Check SQL Service, IP, Firewall" },
            { cat: "Database (SQL Server)", code: "Login failed for user...", role: "APP DEVELOPER", desc_th: "User/Pass ‡∏Ç‡∏≠‡∏á DB ‡∏ú‡∏¥‡∏î", desc_en: "Wrong DB User/Pass", sol_th: "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Connection String", sol_en: "Fix Connection String" },
            { cat: "Database (SQL Server)", code: "Timeout expired", role: "SHARED", desc_th: "Query ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ô‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î", desc_en: "Query Timeout", sol_th: "‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á SQL / ‡∏ó‡∏≥ Index", sol_en: "Tuning SQL / Create Index" },
            { cat: "Database (SQL Server)", code: "Deadlock found", role: "APP DEVELOPER", desc_th: "‡πÅ‡∏¢‡πà‡∏á‡∏Å‡∏±‡∏ô‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Process ‡∏ä‡∏ô‡∏Å‡∏±‡∏ô)", desc_en: "Deadlock (Process conflict)", sol_th: "‡πÉ‡∏ä‡πâ WITH (NOLOCK) / ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö Query ‡πÉ‡∏´‡∏°‡πà", sol_en: "Use WITH (NOLOCK) / Order Query" },
            { cat: "Database (SQL Server)", code: "Transaction log is full", role: "SERVER ADMIN", desc_th: "‡πÑ‡∏ü‡∏•‡πå Log (.ldf) ‡πÄ‡∏ï‡πá‡∏°", desc_en: "Log file (.ldf) full", sol_th: "Backup Log / Shrink File", sol_en: "Backup Log / Shrink File" },
            { cat: "Database (SQL Server)", code: "Msg 3154 (Restore failed)", role: "SERVER ADMIN", desc_th: "Restore ‡∏ó‡∏±‡∏ö DB ‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ", desc_en: "Cannot overwrite existing DB", sol_th: "‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á WITH REPLACE", sol_en: "Use WITH REPLACE" },
            { cat: "Database (SQL Server)", code: "Database State: SUSPECT", role: "SERVER ADMIN", desc_th: "DB ‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢ (‡πÑ‡∏ü‡∏î‡∏±‡∏ö/Disk ‡∏û‡∏±‡∏á)", desc_en: "DB Corrupted (Power loss/Disk fail)", sol_th: "‡πÇ‡∏´‡∏°‡∏î‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô > DBCC CHECKDB", sol_en: "Emergency Mode > DBCC CHECKDB" },
             { cat: "Database (SQL Server)", code: "Conflict with FOREIGN KEY", role: "APP DEVELOPER", desc_th: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏±‡∏î‡πÅ‡∏¢‡πâ‡∏á (Relation ‡∏ú‡∏¥‡∏î)", desc_en: "Foreign Key Conflict", sol_th: "‡πÄ‡∏ä‡πá‡∏Ñ ID ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏£‡∏¥‡∏á", sol_en: "Check ID existence in Master table" },
             { cat: "Database (SQL Server)", code: "Msg 3013 (Backup Corrupted)", role: "SERVER ADMIN", desc_th: "‡πÑ‡∏ü‡∏•‡πå Backup ‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢", desc_en: "Backup File Corrupted", sol_th: "‡πÉ‡∏ä‡πâ RESTORE VERIFYONLY ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ", sol_en: "Use RESTORE VERIFYONLY to check" },

            // Files
            { cat: "File System & Permissions", code: "Access to path denied", role: "SERVER ADMIN", desc_th: "IIS User ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå", desc_en: "IIS User no write permission", sol_th: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡πâ `IIS AppPool\\Name`", sol_en: "Add Permission `IIS AppPool\\Name`" },
            { cat: "File System & Permissions", code: "File in use", role: "SHARED", desc_th: "‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Å‡πÇ‡∏î‡∏¢‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô", desc_en: "File locked by another process", sol_th: "‡πÉ‡∏ä‡πâ Resource Monitor ‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡∏•‡πá‡∏≠‡∏Å", sol_en: "Use Resource Monitor to find lock" },
            { cat: "File System & Permissions", code: "Path too long", role: "APP DEVELOPER", desc_th: "‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô 260 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£", desc_en: "Path exceeds 260 chars", sol_th: "‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå / ‡πÄ‡∏õ‡∏¥‡∏î LongPath", sol_en: "Move file / Enable LongPath" },
             { cat: "File System & Permissions", code: "Access Denied (Full Control)", role: "SERVER ADMIN", desc_th: "‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ", desc_en: "Access Denied despite permissions", sol_th: "‡πÄ‡∏ä‡πá‡∏Ñ Deny Rule / ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå (Owner)", sol_en: "Check Deny Rule / Take Ownership" },

            // Storage
            { cat: "Storage & System Services", code: "Not enough space", role: "SERVER ADMIN", desc_th: "‡∏î‡∏¥‡∏™‡∏Å‡πå‡πÄ‡∏ï‡πá‡∏°", desc_en: "Disk Full", sol_th: "‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏¢‡∏∞ Temp / IIS Logs", sol_en: "Clear Temp / IIS Logs" },
            { cat: "Storage & System Services", code: "Service failed to start", role: "SERVER ADMIN", desc_th: "Service ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (Dependency ‡∏ï‡∏≤‡∏¢)", desc_en: "Service start failed (Dependency)", sol_th: "‡πÄ‡∏£‡∏¥‡πà‡∏° Service ‡∏ï‡∏±‡∏ß‡πÅ‡∏°‡πà‡∏Å‡πà‡∏≠‡∏ô", sol_en: "Start Dependency Service first" },
            { cat: "Storage & System Services", code: "Windows Update Failed", role: "SERVER ADMIN", desc_th: "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡πâ‡∏≤‡∏á/‡∏û‡∏±‡∏á", desc_en: "Update Stuck/Failed", sol_th: "‡∏•‡∏ö‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå SoftwareDistribution", sol_en: "Delete SoftwareDistribution folder" },
             { cat: "Storage & System Services", code: "Task Scheduler Error", role: "SHARED", desc_th: "Task ‡∏£‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô", desc_en: "Task Failed", sol_th: "‡πÄ‡∏ä‡πá‡∏Ñ Path / Run with highest privileges", sol_en: "Check Start In Path / Run with highest privileges" },
             { cat: "Storage & System Services", code: "Server Boot Loop", role: "SERVER ADMIN", desc_th: "‡∏Ñ‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ Boot ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï", desc_en: "Boot Loop after Update", sol_th: "Safe Mode > DISM RevertPendingActions", sol_en: "Safe Mode > DISM RevertPendingActions" },
            
            // Network
            { cat: "Network, Port & SMTP", code: "Connection Refused", role: "SERVER ADMIN", desc_th: "Service ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î", desc_en: "Dest Service not running", sol_th: "Start Service ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á", sol_en: "Start Destination Service" },
            { cat: "Network, Port & SMTP", code: "Port 80/443 in use", role: "SERVER ADMIN", desc_th: "Port ‡∏ä‡∏ô (Skype/VMWare)", desc_en: "Port Conflict (Skype/VMWare)", sol_th: "Netstat ‡∏´‡∏≤ PID > ‡∏õ‡∏¥‡∏î‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°", sol_en: "Netstat find PID > Kill Process" },
            { cat: "Network, Port & SMTP", code: "DNS_PROBE...NXDOMAIN", role: "SERVER ADMIN", desc_th: "‡∏´‡∏≤ Domain ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠", desc_en: "Domain not found", sol_th: "‡πÄ‡∏ä‡πá‡∏Ñ IP DNS Server", sol_en: "Check DNS Server IP" },
            { cat: "Network, Port & SMTP", code: "Request Timed Out", role: "SERVER ADMIN", desc_th: "‡πÄ‡∏ô‡πá‡∏ï‡∏´‡∏•‡∏∏‡∏î / Firewall ‡∏ö‡∏•‡πá‡∏≠‡∏Å", desc_en: "Request Timed Out / Firewall", sol_th: "‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏≤‡∏¢ LAN / VPN / Firewall", sol_en: "Check LAN / VPN / Firewall" },
            
            // Email
            { cat: "Email SMTP (Gmail/Outlook)", code: "5.5.1 Auth Required", role: "APP DEVELOPER", desc_th: "Gmail ‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥", desc_en: "Gmail blocks basic auth", sol_th: "‡πÉ‡∏ä‡πâ App Password", sol_en: "Use App Password" },
            { cat: "Email SMTP (Gmail/Outlook)", code: "Relay Access Denied", role: "SERVER ADMIN", desc_th: "Server ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å IP ‡πÄ‡∏£‡∏≤", desc_en: "Server denies our IP", sol_th: "‡πÄ‡∏û‡∏¥‡πà‡∏° IP ‡πÄ‡∏Ç‡πâ‡∏≤ Whitelist", sol_en: "Add IP to Whitelist" },
             { cat: "Email SMTP (Gmail/Outlook)", code: "Connection Timed Out", role: "SERVER ADMIN", desc_th: "Port 25 ‡πÇ‡∏î‡∏ô‡∏ö‡∏•‡πá‡∏≠‡∏Å", desc_en: "Port 25 Blocked", sol_th: "‡πÉ‡∏ä‡πâ Port 587 (TLS)", sol_en: "Use Port 587 (TLS)" },
             { cat: "Email SMTP (Gmail/Outlook)", code: "5.7.57 Client not auth", role: "SHARED", desc_th: "O365 ‡∏õ‡∏¥‡∏î SMTP Auth", desc_en: "O365 SMTP Auth Disabled", sol_th: "‡πÄ‡∏õ‡∏¥‡∏î Authenticated SMTP ‡πÉ‡∏ô Admin Center", sol_en: "Enable Authenticated SMTP in Admin Center" },
             { cat: "Email SMTP (Gmail/Outlook)", code: "SendAsDenied", role: "APP DEVELOPER", desc_th: "User ‡∏Å‡∏±‡∏ö Email From ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô", desc_en: "User/From Mismatch", sol_th: "‡πÅ‡∏Å‡πâ Email From ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á Login", sol_en: "Match From Email with Login" },
             { cat: "Email SMTP (Gmail/Outlook)", code: "Certificate Validation Failed", role: "SHARED", desc_th: "SSL ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ / Self-signed", desc_en: "SSL Expired / Self-signed", sol_th: "‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏ SSL / ‡∏Ç‡πâ‡∏≤‡∏° Check (‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Dev)", sol_en: "Renew SSL / Skip Check (Dev)" },
            
             // Printer
            { cat: "Printer & RPC", code: "RPC Server unavailable", role: "SERVER ADMIN", desc_th: "‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Service ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ", desc_en: "Cannot contact dest service", sol_th: "Start Print Spooler / ‡πÄ‡∏õ‡∏¥‡∏î Port 135", sol_en: "Start Print Spooler / Open Port 135" },
            { cat: "Printer & RPC", code: "0x0000011b", role: "SERVER ADMIN", desc_th: "Win Update ‡∏ö‡∏•‡πá‡∏≠‡∏Å Printer", desc_en: "Update blocks Printer", sol_th: "‡πÅ‡∏Å‡πâ Registry RpcAuthn...", sol_en: "Fix Registry RpcAuthn..." },
             { cat: "Printer & RPC", code: "0x800706D9 Endpoint Mapper", role: "SERVER ADMIN", desc_th: "Win Firewall Service ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà", desc_en: "Win Firewall Service Disabled", sol_th: "Start Windows Firewall Service", sol_en: "Start Windows Firewall Service" },
             { cat: "Printer & RPC", code: "0x80070035 Network Path Not Found", role: "SERVER ADMIN", desc_th: "‡∏´‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ / SMB ‡∏õ‡∏¥‡∏î", desc_en: "Host not found / SMB off", sol_th: "‡πÄ‡∏õ‡∏¥‡∏î SMB / Ping ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", sol_en: "Enable SMB / Ping Hostname" },
             { cat: "Printer & RPC", code: "0x80070005 Access is denied", role: "SERVER ADMIN", desc_th: "DCOM Permission ‡πÑ‡∏°‡πà‡∏û‡∏≠", desc_en: "Insufficient DCOM Permission", sol_th: "Dcomcnfg > COM Security > Edit Limits", sol_en: "Dcomcnfg > COM Security > Edit Limits" },
             { cat: "Printer & RPC", code: "0x800706BE RPC Call Failed", role: "SERVER ADMIN", desc_th: "Service ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á Crash", desc_en: "Dest Service Crashed", sol_th: "Restart Spooler / ‡∏•‡∏ö Driver", sol_en: "Restart Spooler / Remove Driver" },
             { cat: "Printer & RPC", code: "0x80070721 Security Package", role: "SERVER ADMIN", desc_th: "‡πÄ‡∏ß‡∏•‡∏≤ (Time) ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô", desc_en: "Time sync issue", sol_th: "Sync ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô", sol_en: "Sync Server Time" },
             { cat: "Printer & RPC", code: "0x00000709", role: "SERVER ADMIN", desc_th: "Win 11 ‡∏´‡∏≤ Printer ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠", desc_en: "Win 11 Printer Issue", sol_th: "RegEdit: LegacyDefaultPrinterMode", sol_en: "RegEdit: LegacyDefaultPrinterMode" },
             { cat: "Printer & RPC", code: "Driver unavailable", role: "SERVER ADMIN", desc_th: "Driver V4 ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤", desc_en: "Driver V4 Issue", sol_th: "‡πÉ‡∏ä‡πâ Driver Type 3 (PCL6)", sol_en: "Use Driver Type 3 (PCL6)" },

            // NEW: Log File Locations
            { cat: "Log File Locations", code: "IIS Access Logs", role: "SERVER ADMIN", desc_th: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡πÄ‡∏ß‡πá‡∏ö (Status Code)", desc_en: "Web Access Logs (Status Codes)", sol_th: "C:\\inetpub\\logs\\LogFiles\\W3SVC1", sol_en: "C:\\inetpub\\logs\\LogFiles\\W3SVC1" },
            { cat: "Log File Locations", code: "HTTP Error Logs", role: "SERVER ADMIN", desc_th: "Error ‡∏£‡∏∞‡∏î‡∏±‡∏ö Kernel (‡πÄ‡∏ä‡πà‡∏ô 503)", desc_en: "Kernel Level Errors (e.g. 503)", sol_th: "C:\\Windows\\System32\\LogFiles\\HTTPERR", sol_en: "C:\\Windows\\System32\\LogFiles\\HTTPERR" },
            { cat: "Log File Locations", code: "SQL Server Logs", role: "SERVER ADMIN", desc_th: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î Database", desc_en: "Database Error Logs", sol_th: "C:\\Program Files\\Microsoft SQL Server\\MSSQL...\\Log", sol_en: "C:\\Program Files\\Microsoft SQL Server\\MSSQL...\\Log" },
            { cat: "Log File Locations", code: "Windows Event Viewer", role: "SERVER ADMIN", desc_th: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô", desc_en: "System & Application Logs", sol_th: "Start > Run > eventvwr.msc", sol_en: "Start > Run > eventvwr.msc" },

            // NEW: Connectivity Tricks
            { cat: "Connectivity Tricks", code: "UDL Test", role: "SHARED", desc_th: "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ï‡πà‡∏≠ DB ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Code", desc_en: "Test DB connection without Code", sol_th: "‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå .txt ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏õ‡πá‡∏ô .udl > ‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏Ñ‡∏•‡∏¥‡∏Å", sol_en: "Create .txt file, rename to .udl > Double click" },
            { cat: "Connectivity Tricks", code: "PowerShell Test-NetConnection", role: "SERVER ADMIN", desc_th: "‡πÄ‡∏ä‡πá‡∏Ñ Port ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤ Telnet)", desc_en: "Check Port (Better than Telnet)", sol_th: "tnc [IP] -port [Port]", sol_en: "tnc [IP] -port [Port]" },

            // NEW: Performance Counters
            { cat: "Performance Counters", code: "Processor Time (%)", role: "SERVER ADMIN", desc_th: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á CPU ‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö", desc_en: "Total CPU Usage", sol_th: "‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô 80% ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á = Overload", sol_en: "If > 80% sustained = Overload" },
            { cat: "Performance Counters", code: "Memory\\Available MBytes", role: "SERVER ADMIN", desc_th: "‡πÅ‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà", desc_en: "Available RAM", sol_th: "‡∏ñ‡πâ‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 5% ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏°", sol_en: "If < 5% = Add RAM" },
            { cat: "Performance Counters", code: "ASP.NET\\Requests Queued", role: "SERVER ADMIN", desc_th: "‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•", desc_en: "Requests waiting in queue", sol_th: "‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏£‡∏±‡∏ö Request ‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô", sol_en: "High value = Bottleneck" }
        ];
        
        // Tools Data
        const toolsData = [
            { cmd: "Telnet", ex: "telnet smtp.gmail.com 587", desc_th: "‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ Port ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà", desc_en: "Check if remote Port is open" },
            { cmd: "Test-NetConnection", ex: "tnc 8.8.8.8 -port 53", desc_th: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Telnet ‡πÅ‡∏ï‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô PowerShell (‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏ß‡πà‡∏≤)", desc_en: "Telnet alternative for PowerShell (More details)" },
            { cmd: "Netstat", ex: "netstat -ano | findstr :80", desc_th: "‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏õ‡∏¥‡∏î Port ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", desc_en: "Check local listening ports & PID" },
            { cmd: "Ping", ex: "ping google.com", desc_th: "‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ Server ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏¢‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà", desc_en: "Check if Server is online/reachable" },
            { cmd: "Check Firewall", ex: "Turn off temporarily", desc_th: "‡∏õ‡∏¥‡∏î Firewall ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏¢‡∏Å‡πÅ‡∏¢‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤", desc_en: "Disable Firewall temporarily to isolate issue" }
        ];

        let currentLang = 'th';

        // --- 2. LOGIC: RENDER & STORAGE ---
        
        // Header Mapping
        const tableHeaderMap = {
            "Error / Message": { th: "‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î / ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°", en: "Error / Message" },
            "Responsibility": { th: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö", en: "Responsibility" },
            "Description": { th: "‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ / ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£", en: "Description / Symptom" },
            "Solution": { th: "‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç", en: "Solution" },
            "Error": { th: "‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", en: "Error" },
            "Role": { th: "‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó", en: "Role" },
            "Code": { th: "‡∏£‡∏´‡∏±‡∏™", en: "Code" },
            "Command": { th: "‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á", en: "Command" },
            "Example": { th: "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á", en: "Example" },
            "Purpose": { th: "‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå", en: "Purpose" },
            "Error / Symptom": { th: "‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î / ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£", en: "Error / Symptom" },
            "Counter Name": { th: "‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î", en: "Counter Name" },
            "Threshold (‡∏Ñ‡πà‡∏≤‡∏ß‡∏¥‡∏Å‡∏§‡∏ï)": { th: "‡∏Ñ‡πà‡∏≤‡∏ß‡∏¥‡∏Å‡∏§‡∏ï (Threshold)", en: "Threshold" },
            "Technique": { th: "‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ", en: "Technique" },
            "How-to": { th: "‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥", en: "How-to" },
            "Log Type": { th: "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó Log", en: "Log Type" },
            "Path / Location": { th: "‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏ü‡∏•‡πå (Path)", en: "Path / Location" }
        };

        const roleColors = {
            "SERVER ADMIN": "bg-purple-100 text-purple-700",
            "APP DEVELOPER": "bg-emerald-100 text-emerald-700",
            "SHARED": "bg-orange-100 text-orange-700",
            "SHARED / BOTH": "bg-orange-100 text-orange-700"
        };

        const catMap = {
            "HTTP Status Codes": "tbody-http",
            "IIS & ASP.NET Application": "tbody-iis",
            "IIS Application Pool Strategy": "tbody-apppool",
            "Browser & SSL/TLS": "tbody-browser",
            "Libraries & MS Office": "tbody-lib",
            "Identity (AD, Azure, IIS Auth)": "tbody-identity",
            "Database (SQL Server)": "tbody-db",
            "File System & Permissions": "tbody-files",
            "Storage & System Services": "tbody-storage",
            "Network, Port & SMTP": "tbody-network",
            "Email SMTP (Gmail/Outlook)": "tbody-email",
            "Printer & RPC": "tbody-printer",
            "Log File Locations": "tbody-logfiles",
            "Connectivity Tricks": "tbody-connectivity",
            "Performance Counters": "tbody-perf"
        };
        
        // Category Headers Translation
        const categoryTitles = {
            "HTTP Status Codes": { th: "‡∏£‡∏´‡∏±‡∏™‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ HTTP (HTTP Status Codes)", en: "HTTP Status Codes" },
            "IIS & ASP.NET Application": { th: "‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô IIS & ASP.NET", en: "IIS & ASP.NET Application" },
            "IIS Application Pool Strategy": { th: "‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ IIS App Pool", en: "IIS Application Pool Strategy" },
            "Browser & SSL/TLS": { th: "‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå & SSL/TLS", en: "Browser & SSL/TLS" },
            "Libraries & MS Office": { th: "‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ & MS Office", en: "Libraries & MS Office" },
            "Identity (AD, Azure, IIS Auth)": { th: "‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô (AD, Azure, IIS)", en: "Identity (AD, Azure, IIS Auth)" },
            "Database (SQL Server)": { th: "‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (SQL Server)", en: "Database (SQL Server)" },
            "File System & Permissions": { th: "‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á (Permissions)", en: "File System & Permissions" },
            "Storage & System Services": { th: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö & ‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ß‡∏¥‡∏™‡∏£‡∏∞‡∏ö‡∏ö", en: "Storage & System Services" },
            "Network, Port & SMTP": { th: "‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢, ‡∏û‡∏≠‡∏£‡πå‡∏ï & SMTP", en: "Network, Port & SMTP" },
            "Email SMTP (Gmail/Outlook)": { th: "‡∏≠‡∏µ‡πÄ‡∏°‡∏• SMTP (Gmail/Outlook)", en: "Email SMTP (Gmail/Outlook)" },
            "Printer & RPC": { th: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå & RPC", en: "Printer & RPC" },
            "Basic Troubleshooting Tools": { th: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô", en: "Basic Troubleshooting Tools" },
            "Log File Locations": { th: "‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå Log ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç", en: "Important Log File Locations" },
            "Connectivity Tricks": { th: "‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ (No Code)", en: "Connectivity Tricks (No Code)" },
            "Performance Counters": { th: "‡∏Ñ‡πà‡∏≤ Performance ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π", en: "Key Performance Counters" }
        };

        function getData() {
            const localData = localStorage.getItem('errorGuideData');
            return localData ? JSON.parse(localData) : defaultData;
        }

        function saveData(data) {
            localStorage.setItem('errorGuideData', JSON.stringify(data));
            renderTables();
        }

        function clearLocalStorage() {
            const msg = currentLang === 'th' ? "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô?" : "Are you sure you want to reset to default data?";
            if(confirm(msg)) {
                localStorage.removeItem('errorGuideData');
                renderTables();
                alert(currentLang === 'th' ? "‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢" : "Data reset successful.");
            }
        }
        
        function toggleLanguage() {
            currentLang = currentLang === 'th' ? 'en' : 'th';
            document.getElementById('lang-icon').textContent = currentLang === 'th' ? 'üáπüá≠' : 'üá¨üáß';
            document.getElementById('lang-text').textContent = currentLang === 'th' ? 'TH' : 'EN';
            
            // Toggle Static Text
            document.querySelectorAll('.lang-th').forEach(el => {
                if(currentLang === 'th') el.classList.remove('hidden'); else el.classList.add('hidden');
            });
            document.querySelectorAll('.lang-en').forEach(el => {
                if(currentLang === 'en') el.classList.remove('hidden'); else el.classList.add('hidden');
            });
            
            updateDynamicHeaders();
            renderTables();
        }
        
        function updateDynamicHeaders() {
            // Update Category Headers
            document.querySelectorAll('.category-section').forEach(section => {
                const catKey = section.getAttribute('data-category');
                const titleEl = section.querySelector('h2');
                if (titleEl && catKey && categoryTitles[catKey]) {
                   titleEl.textContent = currentLang === 'th' ? categoryTitles[catKey].th : categoryTitles[catKey].en;
                }
            });
            
            // Update Table Headers
            document.querySelectorAll('th').forEach(th => {
                 const text = th.innerText.trim();
                 for (const [key, val] of Object.entries(tableHeaderMap)) {
                     if (val.th === text || val.en === text) {
                         th.textContent = currentLang === 'th' ? val.th : val.en;
                         break;
                     }
                 }
            });
        }

        function renderTables() {
            const data = getData();
            
            // Clear all tbodies
            Object.values(catMap).forEach(id => {
                const el = document.getElementById(id);
                if(el) el.innerHTML = "";
            });

            // Render Error Tables
            data.forEach(item => {
                const tbodyId = catMap[item.cat];
                if (tbodyId) {
                    const tbody = document.getElementById(tbodyId);
                    if (tbody) {
                        const row = document.createElement('tr');
                        row.className = "hover:bg-slate-50 transition-colors";
                        const roleClass = roleColors[item.role] || "bg-gray-100 text-gray-700";
                        
                        // Fallback logic for mixed data sources (imported vs default)
                        const desc = currentLang === 'th' ? (item.desc_th || item.desc) : (item.desc_en || item.desc || item.desc_th);
                        const sol = currentLang === 'th' ? (item.sol_th || item.sol) : (item.sol_en || item.sol || item.sol_th);

                        row.innerHTML = `
                            <td class="p-4 font-mono text-red-600 font-medium">${item.code}</td>
                            <td class="p-4"><span class="px-2 py-1 ${roleClass} rounded text-xs font-bold">${item.role}</span></td>
                            <td class="p-4 text-slate-600">${desc}</td>
                            <td class="p-4 text-slate-700">${sol}</td>
                        `;
                        tbody.appendChild(row);
                    }
                }
            });
            
            // Render Tools Table
            const toolsContainer = document.getElementById('tools-container');
            if (toolsContainer) {
                const cmdHeader = currentLang === 'th' ? "‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á" : "Command";
                const exHeader = currentLang === 'th' ? "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á" : "Example";
                const purpHeader = currentLang === 'th' ? "‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå" : "Purpose";
                
                const toolsHtml = `
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-slate-200">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead><tr class="bg-slate-50 border-b border-slate-200 text-slate-600 text-sm uppercase tracking-wider">
                                <th class="p-4 w-1/4">${cmdHeader}</th>
                                <th class="p-4 w-1/3">${exHeader}</th>
                                <th class="p-4 w-1/3">${purpHeader}</th>
                            </tr></thead>
                            <tbody class="divide-y divide-slate-100 text-sm md:text-base search-target">
                                ${toolsData.map(t => `
                                <tr class="hover:bg-slate-50">
                                    <td class="p-4 font-bold">${t.cmd}</td>
                                    <td class="p-4"><code class="cmd-box">${t.ex}</code></td>
                                    <td class="p-4">${currentLang === 'th' ? t.desc_th : t.desc_en}</td>
                                </tr>`).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>`;
                toolsContainer.innerHTML = toolsHtml;
            }
            
            // Call update dynamic headers to ensure section titles match lang
            updateDynamicHeaders();
        }

        // --- 3. EXPORT / IMPORT / TEMPLATE LOGIC ---
        function exportData(type) {
            document.getElementById('exportMenu').classList.add('hidden');
            const data = getData();
            const exportData = data.map(item => ({
                "Category": item.cat,
                "Code": item.code,
                "Role": item.role,
                "Desc_TH": item.desc_th || item.desc,
                "Desc_EN": item.desc_en || item.desc,
                "Sol_TH": item.sol_th || item.sol,
                "Sol_EN": item.sol_en || item.sol
            }));
            const ws = XLSX.utils.json_to_sheet(exportData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "System Errors");
            XLSX.writeFile(wb, type === 'csv' ? "System_Error_Guide.csv" : "System_Error_Guide.xlsx");
        }

        function toggleExportMenu() {
            const menu = document.getElementById('exportMenu');
            menu.classList.toggle('hidden');
        }

        window.addEventListener('click', function(e) {
            const btn = document.querySelector('button[onclick="toggleExportMenu()"]');
            const menu = document.getElementById('exportMenu');
            if (btn && menu && !btn.contains(e.target) && !menu.contains(e.target)) {
                menu.classList.add('hidden');
            }
        });

        function downloadTemplate() {
            const templateData = [{ "Category": "HTTP Status Codes", "Code": "500", "Role": "APP DEVELOPER", "Desc_TH": "‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÑ‡∏ó‡∏¢", "Desc_EN": "English Description", "Sol_TH": "‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏ó‡∏¢", "Sol_EN": "English Solution" }];
            const ws = XLSX.utils.json_to_sheet(templateData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Template");
            XLSX.writeFile(wb, "System_Error_Template.csv");
        }

        function triggerImport() { document.getElementById('fileInput').click(); }

        function handleFileImport(input) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, {type: 'array'});
                const json = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
                
                const importedItems = json.map(row => ({
                    cat: row["Category"], code: row["Code"], role: row["Role"],
                    desc_th: row["Desc_TH"] || row["Desc"], // Fallback if old format
                    desc_en: row["Desc_EN"] || row["Desc"],
                    sol_th: row["Sol_TH"] || row["Sol"],
                    sol_en: row["Sol_EN"] || row["Sol"]
                })).filter(item => item.cat && item.code);

                if (importedItems.length > 0) {
                    const currentData = getData();
                    saveData(currentData.concat(importedItems));
                    alert(currentLang === 'th' ? `‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${importedItems.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£!` : `Imported ${importedItems.length} items!`);
                }
                input.value = "";
            };
            reader.readAsArrayBuffer(file);
        }
        
        // Modal Logic
        function toggleModal(modalID){
            const modal = document.getElementById(modalID);
            modal.classList.toggle("opacity-0");
            modal.classList.toggle("pointer-events-none");
            document.body.classList.toggle("modal-active");
        }
        
        function handleAddNew(e) {
            e.preventDefault();
             const newItem = {
                cat: document.getElementById('newCategory').value,
                code: document.getElementById('newCode').value,
                role: document.getElementById('newRole').value,
                desc_th: document.getElementById('newDescTh').value,
                desc_en: document.getElementById('newDescEn').value,
                sol_th: document.getElementById('newSolTh').value,
                sol_en: document.getElementById('newSolEn').value
            };
            const currentData = getData();
            currentData.push(newItem);
            saveData(currentData);
            toggleModal('addModal');
            alert(currentLang === 'th' ? "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!" : "Data Added Successfully!");
            document.getElementById('addErrorForm').reset();
        }

        // --- AI LOGIC (GEMINI) ---
        async function handleAiAnalyze() {
            const input = document.getElementById('aiInput').value;
            if (!input.trim()) return;

            const outputDiv = document.getElementById('aiOutput');
            const loadingDiv = document.getElementById('aiLoading');
            
            outputDiv.classList.add('hidden');
            loadingDiv.classList.remove('hidden');

            const langInstruction = currentLang === 'th' ? "Respond in Thai language." : "Respond in English language.";

            try {
                const prompt = `You are an expert IT System Administrator. Analyze the following error log or symptom and provide: 1. Possible Root Cause 2. Step-by-step Solution 3. Prevention Tips. ${langInstruction}
                Format the response with simple HTML tags (<b>, <ul>, <li>, <br>, <code>) for readability inside a div. Do NOT use markdown code blocks.
                User Input: ${input}`;

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });

                const data = await response.json();
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "Unable to analyze. Please try again.";

                outputDiv.innerHTML = text;
                outputDiv.classList.remove('hidden');
            } catch (e) {
                outputDiv.innerHTML = `<span class="text-red-600">API Error: ${e.message}</span>`;
                outputDiv.classList.remove('hidden');
            } finally {
                loadingDiv.classList.add('hidden');
            }
        }

        // --- UI TABS ---
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('block'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active', 'bg-blue-600', 'text-white', 'border-blue-600'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.add('bg-white', 'text-slate-600', 'border-slate-300'));

            const tabContent = document.getElementById(tabId);
            if (tabContent) {
                tabContent.classList.remove('hidden');
                tabContent.classList.add('block');
            }

            let btn = document.getElementById('btn-' + tabId);
            if (btn) {
                btn.classList.remove('bg-white', 'text-slate-600', 'border-slate-300');
                btn.classList.add('active', 'bg-blue-600', 'text-white', 'border-blue-600');
            }
        }

        document.getElementById('searchInput').addEventListener('keyup', function() {
            let filter = this.value.toLowerCase();
            let rows = document.querySelectorAll('.search-target tr');
            let tabContainer = document.getElementById('tabContainer');
            let searchStatus = document.getElementById('searchStatus');
            let allTabs = document.querySelectorAll('.tab-content');

            if (filter.length > 0) {
                allTabs.forEach(el => { el.classList.remove('hidden'); el.classList.add('block'); });
                tabContainer.classList.add('hidden');
                searchStatus.classList.remove('hidden');
                rows.forEach(row => {
                    let text = row.textContent.toLowerCase();
                    row.style.display = text.includes(filter) ? '' : 'none';
                });
            } else {
                rows.forEach(row => row.style.display = '');
                tabContainer.classList.remove('hidden');
                searchStatus.classList.add('hidden');
                switchTab('web-app');
            }
        });

        // Initialize on DOM Ready
        document.addEventListener('DOMContentLoaded', () => {
            renderTables();
            switchTab('web-app');
        });

    </script>
</body>
</html>